{% extends "marketing_base.html" %}

{% load i18n tz %}

{% block content %}

  <div class="container marketing-page">

    <article class="blog-article">

      <div class="row d-flex flex-row align-items-end">
        <div class="col-lg-8">

          <header class="mb-0">
            <h1>
              {{ blog_post.title }}
            </h1>
            {% if blog_post.summary %}
              <div class="lead text-muted mb-0">
                {{ blog_post.summary }}
              </div>
            {% endif %}
          </header>

          <div class="blog-article__meta d-flex flex-column flex-md-row gap-2 align-items-md-center text-muted mt-2">
            <span>
              {% trans "By" %}
              {% if blog_post.author and blog_post.author.name %}
                {{ blog_post.author.name }}
              {% elif blog_post.author %}
                {{ blog_post.author.username }}
              {% else %}
                {% trans "SimpleValidations Team" %}
              {% endif %}
            </span>
            <span class="d-none d-md-inline">•</span>
            <time datetime="{{ blog_post.published_on|localtime|date:'c' }}">
              {{ blog_post.published_on|localtime|date:"DATE_FORMAT" }}
            </time>
          </div>
        </div>
      </div>

      <div class="row mt-5">
        <div class="col-12 col-lg-8 ">
          {% if blog_post.featured_image %}
            <figure class="blog-article__figure mb-5">
              <img src="{{ blog_post.featured_image.url }}"
                   alt="{{ blog_post.featured_image_alt|default:blog_post.title }}"
                   class="img-fluid rounded-4 w-100 shadow-sm" />
              {% if blog_post.featured_image_credit %}
                <figcaption class="ms-2 text-muted small mt-2">
                  {{ blog_post.featured_image_credit|safe }}
                </figcaption>
              {% endif %}
            </figure>
          {% endif %}

          <div class="blog-article__content prose">
            {{ blog_post.content|safe }}
          </div>

          <div class="mt-5">
            <a class="btn btn-outline-primary"
               href="{% url 'marketing:blog:blog_list' %}">
              ⇐ {% trans "Back to blog list" %}
            </a>
          </div>
        </div>
      </div>

      {% if related_posts %}
        <div class="row mt-5">
          <div class="col-12 col-lg-8 ">
            <h2 class="h4 fw-semibold mb-4">
              {% trans "Keep reading" %}
            </h2>
          </div>
        </div>
        <div class="row g-4 g-lg-5">
          {% for related in related_posts %}
            <div class="col-12 col-md-6 col-lg-4">
              <article class="h-100">
                <a class="card feature-link-card blog-card h-100 text-decoration-none text-reset"
                   href="{% url 'marketing:blog:blog_post_detail' related.slug %}">
                  <div class="blog-card__media">
                    {% if related.featured_image %}
                      <img src="{{ related.featured_image.url }}"
                           alt="{{ related.featured_image_alt|default:related.title }}" />
                    {% else %}
                      <span class="blog-card__media-placeholder">
                        {% trans "SimpleValidations" %}
                      </span>
                    {% endif %}
                  </div>
                  <div class="card-body">
                    <div class="blog-card__meta d-flex align-items-center gap-2 flex-wrap">
                      <span>
                        {% if related.author and related.author.name %}
                          {{ related.author.name }}
                        {% elif related.author %}
                          {{ related.author.username }}
                        {% else %}
                          {% trans "SimpleValidations Team" %}
                        {% endif %}
                      </span>
                      <span>•</span>
                      <time datetime="{{ related.published_on|localtime|date:'c' }}">
                        {{ related.published_on|localtime|date:"DATE_FORMAT" }}
                      </time>
                    </div>
                    <h3 class="h5 fw-semibold mb-1">
                      {{ related.title }}
                    </h3>
                    <p class="text-muted mb-0 flex-grow-1">
                      {{ related.content|striptags|truncatechars:140 }}
                    </p>
                  </div>
                  <div class="card-footer bg-transparent border-0 pt-0">
                    <span class="blog-card__read-more fw-semibold">
                      {% trans "Read more" %}
                      <i class="bi bi-arrow-right-short"></i>
                    </span>
                  </div>
                </a>
              </article>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    </article>
  </div>
{% endblock content %}
