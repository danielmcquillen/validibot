{% load i18n static core_tags %}

<div class="card shadow-sm h-100 workflow-card"
     id="workflow-card-{{ workflow.pk }}">
    <div class="card-header d-flex justify-content-between align-items-center">
        <div class="d-flex flex-column align-items-start gap-2">
            <div>
                <i class="bi bi-box me-2"></i>{{ workflow.name }}
            </div>
            {% if workflow.is_locked %}
                <span class="badge text-bg-warning text-dark">
                    {% trans "Locked" %}
                </span>
            {% endif %}
        </div>

        {% if workflow.is_active %}
            <span class="badge text-bg-success ms-1">
                {% trans "Active" %}
            </span>
        {% else %}
            <span class="badge text-bg-warning ms-1">
                {% trans "Inactive" %}
            </span>
        {% endif %}
    </div>
    <div class="card-body d-flex flex-column">

        <dl class="card-data-item">
            <dt>
                {% trans "Project" %}:
            </dt>
            <dd>
                {% if workflow.project %}
                    <span class="badge rounded-pill border border-1 workflow-project-badge"
                          style="background-color: {{ workflow.project.color }};
                                 color: {{ workflow.project.badge_text_color }};
                                 border-color: {{ workflow.project.badge_border_color }}"
                          title="{{ workflow.project.name }}">
                        {{ workflow.project.name }}
                    </span>
                {% endif %}
            </dd>
        </dl>

        <dl class="card-data-item">
            <dt>
                {% trans "Slug" %}:
            </dt>
            <dd class="value">
                {{ workflow.slug }}
            </dd>
        </dl>

        <dl class="card-data-item">
            <dt>
                {% trans "Version" %}:
            </dt>
            <dd>
                <span class="badge text-bg-light align-self-start">
                    {% if workflow.version %}
                        {{ workflow.version }}
                    {% else %}
                        {% trans "Unversioned" %}
                    {% endif %}
                </span>
            </dd>
        </dl>

        <dl class="card-data-item">
            <dt>
                {% trans "Updated" %}:
            </dt>
            <dd>
                {{ workflow.modified|date:"M j, Y" }}
            </dd>
        </dl>

    </div>
    <div class="card-footer">
        <div class="mt-auto d-flex flex-wrap gap-2 justify-content-end align-items-center">
            <a class="btn btn-sm btn-primary"
               href="{% org_url 'workflows:workflow_detail' pk=workflow.pk %}">
                <i class="bi bi-pencil-square me-1"></i>
                {% trans "Edit steps" %}
            </a>
            <a class="btn btn-sm btn-outline-secondary"
               href="{% org_url 'workflows:workflow_update' pk=workflow.pk %}"
               data-bs-toggle="tooltip"
               data-bs-placement="top"
               aria-label="{% blocktrans with workflow_name=workflow.name trimmed %}Edit settings for {{ workflow_name }}{% endblocktrans %}"
               title="{% trans "Edit workflow settings" %}">
                <i class="bi bi-gear-fill"></i>
                <span class="visually-hidden">
                    {% trans "Edit workflow settings" %}
                </span>
            </a>
            <button type="button"
                    class="btn btn-sm btn-outline-danger"
                    hx-delete="{% org_url 'workflows:workflow_delete' pk=workflow.pk %}"
                    hx-target="#workflow-card-wrapper-{{ workflow.pk }}"
                    hx-swap="outerHTML"
                    hx-confirm="{% trans "Delete this workflow?" %}">
                {% trans "Delete" %}
            </button>
        </div>
    </div>
</div>
