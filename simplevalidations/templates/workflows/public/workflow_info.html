{% extends "marketing_base.html" %}

{% load i18n humanize %}

{% block page_title %}
  {{ workflow.name }} Â· {% trans "Workflow overview" %}
{% endblock page_title %}

{% block content %}

  <section class="py-4">
    <div class="container">
      {# login call to action #}
      <div class="alert alert-info mt-0" role="alert">
        <div class="d-flex flex-column flex-lg-row align-items-start align-items-lg-center gap-3">
          <div class="d-flex align-items-center gap-2">
            <i class="bi-info-circle-fill fs-4"></i>
            <span class="fw-semibold">
              {% trans "Workflow access" %}
            </span>
          </div>
          <div class="flex-grow-1">
            {% if request.user.is_authenticated %}
              {% if user_has_access %}
                {% blocktrans %}
                  You can manage this workflow from the internal app.
                {% endblocktrans %}
              {% else %}
                {% blocktrans %}
                  You do not currently have permission to run this workflow. Contact the workflow owner to request access.
                {% endblocktrans %}
              {% endif %}
            {% else %}
              {% blocktrans %}
                Sign in to your SimpleValidations account to request access or launch this workflow.
              {% endblocktrans %}
            {% endif %}
          </div>
          <div class="ms-lg-auto d-flex gap-2">
            {% if request.user.is_authenticated %}
              <a href="{% url 'workflows:workflow_launch' workflow.pk %}"
                 class="btn btn-primary">
                {% trans "Open in app" %}
              </a>
            {% else %}
              <a href="{% url 'account_login' %}" class="btn btn-outline-primary">
                {% trans "Sign in" %}
              </a>
              <a href="{% url 'account_signup' %}" class="btn btn-primary">
                {% trans "Start trial" %}
              </a>
            {% endif %}
          </div>
        </div>
      </div>

      {% include "workflows/launch/_public_info_tab.html" with workflow=workflow public_info=workflow.get_public_info %}

    </div>
  </section>
{% endblock content %}
