{% extends "app_base.html" %}

{% load markdownify %}

{% block content %}
    <div class="container my-4">
        <div class="row">
            <aside class="col-md-3 col-lg-2 mb-3 mb-md-0">
                <nav class="help-nav">

                    {# Index link at top #}
                    {% if index_item %}
                        <div class="mb-3">
                            <ul class="nav nav-pills flex-column">
                                <li class="nav-item">
                                    <a class="nav-link
                                              {% if index_item.page.id == page.id %}
                                                  active
                                              {% endif %}"
                                       href="{{ index_item.page.url }}">
                                        {{ index_item.page.title }}
                                    </a>
                                </li>
                            </ul>
                        </div>
                    {% endif %}

                    {# IMPORTANT: use section_label, not section #}
                    {% regroup nav_items by section_label as section_list %}

                    {% for group in section_list %}
                        <div class="mb-3">
                            <div class="text-uppercase text-muted small mb-1">
                                {{ group.grouper }}
                            </div>
                            <ul class="nav nav-pills flex-column">
                                {% for item in group.list %}
                                    {% with p=item.page %}
                                        <li class="nav-item">
                                            <a class="nav-link
                                                      {% if p.id == page.id %}
                                                          active
                                                      {% endif %}"
                                               href="{{ p.url }}">
                                                {{ p.title }}
                                            </a>
                                        </li>
                                    {% endwith %}
                                {% endfor %}
                            </ul>
                        </div>
                    {% endfor %}

                </nav>
            </aside>

            <main class="col-md-9 col-lg-10">
                <article class="help-article">
                    <header class="mb-3">
                        <h1 class="h3">
                            {{ page.title }}
                        </h1>
                    </header>
                    <div class="help-body">
                        {{ page.content|markdownify }}
                    </div>
                </article>
            </main>
        </div>
    </div>
{% endblock %}
