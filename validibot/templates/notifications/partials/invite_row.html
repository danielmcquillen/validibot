{% load i18n %}

{% with invite=notification.invite %}
  <div class="alert alert-info border alert-dismissible fade show d-flex justify-content-between align-items-start"
       role="alert">
    <div>
      <div class="fw-semibold mb-1">
        {% if invite %}
          {% blocktrans with org=invite.org.name %}Invitation to {{ org }}{% endblocktrans %}
        {% else %}
          {% trans "Invitation" %}
        {% endif %}
      </div>
      <div class="text-muted small">
        {% trans "Organization:" %} {{ notification.org.name }}
      </div>
      <div class="text-muted small">
        {{ notification.created_at|date:"Y-m-d H:i" }}
      </div>
    </div>
    <div class="d-flex gap-2 align-items-start">
      {% if invite and invite.status == "PENDING" and not notification.dismissed_at %}
        <form method="post"
              action="{% url 'notifications:notification-invite-accept' notification.pk %}">
          {% csrf_token %}
          <button type="submit" class="btn btn-sm btn-success">
            {% trans "Accept" %}
          </button>
        </form>
        <form method="post"
              action="{% url 'notifications:notification-invite-decline' notification.pk %}">
          {% csrf_token %}
          <button type="submit" class="btn btn-sm btn-outline-secondary">
            {% trans "Decline" %}
          </button>
        </form>
      {% else %}
        <span class="badge
                     {% if invite and invite.status == "ACCEPTED" %}
                       text-bg-success
                     {% else %}
                       text-bg-light
                     {% endif %}">
          {% if invite %}
            {{ invite.status }}
          {% else %}
            {% trans "Processed" %}
          {% endif %}
        </span>
      {% endif %}

      {% if notification and notification.can_dismiss and not notification.dismissed_at %}
        <form method="post"
              hx-post="{% url 'notifications:notification-dismiss' notification.pk %}"
              hx-target="closest .alert"
              hx-swap="outerHTML">
          {% csrf_token %}
          {% if show_dismissed %}
            <input type="hidden" name="show_dismissed" value="on" />
          {% endif %}
          <button type="submit"
                  class="btn-close"
                  aria-label="{% trans 'Dismiss' %}"
                  title="{% trans 'Dismiss notification' %}">
          </button>
        </form>
      {% elif notification and notification.dismissed_at %}
        <span class="text-muted small fst-italic">
          {% trans "(notification dismissed)" %}
        </span>
      {% endif %}
    </div>
  </div>
{% endwith %}
