{% load i18n core_tags %}

<div class="card app-card mb-3" id="workflow-visibility-section">
  <div class="card-header">
    <div class="card-title">{% trans "Visibility" %}</div>
  </div>
  <div class="card-body">
    <div class="d-flex flex-column gap-3">
      {# Private option #}
      <div class="form-check">
        <input class="form-check-input"
               type="radio"
               name="visibility"
               id="visibility-private"
               value="private"
               {% if not workflow.is_public %}checked{% endif %}
               {% if can_manage_sharing %} hx-post="{% org_url 'workflows:workflow_visibility_update' pk=workflow.pk %}" hx-target="#workflow-visibility-section" hx-swap="outerHTML" hx-vals='{"is_public": "false"}' {% else %} disabled {% endif %} />
        <label class="form-check-label d-flex align-items-start gap-2"
               for="visibility-private">
          <div>
            <span class="fw-medium">
              <i class="bi-lock me-1"></i>{% trans "Private" %}
            </span>
            {% if not workflow.is_public %}
              <span class="badge text-bg-secondary ms-2">{% trans "Current" %}</span>
            {% endif %}
            <p class="text-muted small mb-0 mt-1">{% trans "Only org members and invited guests can launch this workflow." %}</p>
          </div>
        </label>
      </div>
      {# Public option #}
      <div class="form-check">
        <input class="form-check-input"
               type="radio"
               name="visibility"
               id="visibility-public"
               value="public"
               {% if workflow.is_public %}checked{% endif %}
               {% if can_manage_sharing %} hx-post="{% org_url 'workflows:workflow_visibility_update' pk=workflow.pk %}" hx-target="#workflow-visibility-section" hx-swap="outerHTML" hx-vals='{"is_public": "true"}' {% else %} disabled {% endif %} />
        <label class="form-check-label d-flex align-items-start gap-2"
               for="visibility-public">
          <div>
            <span class="fw-medium">
              <i class="bi-globe me-1"></i>{% trans "Public" %}
            </span>
            {% if workflow.is_public %}
              <span class="badge text-bg-primary ms-2">{% trans "Current" %}</span>
            {% endif %}
            <p class="text-muted small mb-0 mt-1">
              {% trans "Any logged-in user can launch this workflow. Usage is billed to your organization." %}
            </p>
          </div>
        </label>
      </div>
    </div>
    {% if workflow.is_public %}
      <div class="alert alert-info mt-3 mb-0 small">
        <i class="bi-info-circle me-1"></i>
        {% trans "The info page is automatically made public when the workflow is public." %}
      </div>
    {% endif %}
  </div>
</div>
